<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="APEX IR XLSX Downloader : Download APEX Interactive Report to XLSX file">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>APEX IR XLSX Downloader</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/commi235/APEX_IR_XLSX">View on GitHub</a>

          <h1 id="project_title">APEX IR XLSX Downloader</h1>
          <h2 id="project_tagline">Download APEX Interactive Report to XLSX file</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/commi235/APEX_IR_XLSX/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/commi235/APEX_IR_XLSX/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="apexir_xlsx" class="anchor" href="#apexir_xlsx" aria-hidden="true"><span class="octicon octicon-link"></span></a>APEXIR_XLSX</h1>

<p>Download APEX Interactive Reports as XLSX files.<br>
With this package you can download any Interactive report using the standard Excel file format.<br>
Main benefits are that all data types are preserved and stored in a way that Excel recognizes them properly.</p>

<h2>
<a id="supported-functionality" class="anchor" href="#supported-functionality" aria-hidden="true"><span class="octicon octicon-link"></span></a>SUPPORTED FUNCTIONALITY</h2>

<ul>
<li> Filtering and Sorting</li>
<li> Control Breaks</li>
<li> Computations</li>
<li> Aggregations (with a small limitation, see below)</li>
<li> Highlights</li>
<li> VARCHAR2 columns</li>
<li> DATE columns including formatting (supports &amp;APP_DATE_TIME_FORMAT. substitution)</li>
<li> NUMBER columns including formatting</li>
<li> CLOBs (limited to 32767 characters)</li>
<li> "Group By" view mode (for limitations see below)</li>
<li> Display column help text as comment on respective column header.</li>
</ul>

<h2>
<a id="current-limitations" class="anchor" href="#current-limitations" aria-hidden="true"><span class="octicon octicon-link"></span></a>CURRENT LIMITATIONS</h2>

<ol>
<li>CLOB columns are supported but converted to VARCHAR2(32767) before inserted into the spreadsheet.<br>
Support for full size CLOBs is planned for a future release.</li>
<li>TIMESTAMP columns are treated like DATE columns.<br>
Full support for TIMESTAMP is planned for a future release.</li>
<li>Aggregates defined on the first column of any report are ignored.<br>
The cell is needed to display the aggregation type.<br>
Currently there are no immediate plans to lift that restriction.</li>
<li>For the "Group By" view report to work all used columns also need to be present in the "Standard" report view.<br>
The APEX engine only exposes the SQL query of the standard view currently.<br>
</li>
<li>The download only works for authenticated users.<br>
The APEX engine does not give back base_report_id if user isn't authenticated.<br>
Research is currently ongoing to lift this restriction.</li>
</ol>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>INSTALLATION</h2>

<p>Navigate to folder "setup".
Simply run the script "install_all.sql" if you want everything installed at once.<br>
If you have the referenced libraries already you can run "install_main.sql" to install the main package.<br>
Libraries can be installed standalone by using "install_libs.sql".</p>

<p>You can also manually create the packages by running the separate package specifications and bodies in your favourite IDE.</p>

<h2>
<a id="how-to-use" class="anchor" href="#how-to-use" aria-hidden="true"><span class="octicon octicon-link"></span></a>HOW TO USE</h2>

<h3>
<a id="enable-download-for-a-single-interactive-report" class="anchor" href="#enable-download-for-a-single-interactive-report" aria-hidden="true"><span class="octicon octicon-link"></span></a>Enable download for a single interactive report</h3>

<ol>
<li>Create the interactive report region. (skip if you already have one)</li>
<li>Run the page and inspect the source code using your browser.</li>
<li>Mark down the value of the hidden item with id "apexir_REGION_ID" removing the "R" at the beginning.<br>
The numeric value you now have is the only mandatory input to the main function.</li>
<li>Create button or similar element to reload page setting request to "XLSX".</li>
<li>Create page process (sample)<br>
Type: PL/SQL anonymous block<br>
Process Point: On Load - Before Header 
Condition Type: Request = Expression 1<br>
Expression 1: XLSX<br>
Process (replace $APEXIR_REGION_ID$ with number from step above):<br>
</li>
</ol>

<div class="highlight highlight-sql"><pre>   <span class="pl-c1">apexir_xlsx_pkg</span>.<span class="pl-c1">download</span>( p_ir_region_id <span class="pl-k">=&gt;</span> $APEXIR_REGION_ID$);</pre></div>

<h3>
<a id="enable-download-for-all-interactive-reports-in-application" class="anchor" href="#enable-download-for-all-interactive-reports-in-application" aria-hidden="true"><span class="octicon octicon-link"></span></a>Enable download for all interactive reports in application</h3>

<ol>
<li>Create an application item to hold the requested interactive report id. 
We'll assume the item is called APEXIR_REGION_ID in the following.</li>
<li>
<p>Create Application Computation<br>
Computation Item: APEXIR_REGION_ID<br>
Computation Point: Before Header<br>
Computation Type: SQL Query (return single value)<br>
Condition Type: Request != Expression 1<br>
Expression 1: XLSX<br>
Computation (if you have only one IR on the page):</p>

<div class="highlight highlight-sql"><pre><span class="pl-k">SELECT</span> region_id
  <span class="pl-k">FROM</span> apex_application_page_ir
 <span class="pl-k">WHERE</span> application_id <span class="pl-k">=</span> :APP_ID
   <span class="pl-k">AND</span> page_id <span class="pl-k">=</span> :APP_PAGE_ID</pre></div>
</li>
<li>
<p>Create Application Process<br>
Type: PL/SQL anonymous block<br>
Process Point: On Load - Before Header<br>
Condition Type: Request = Expression 1<br>
Expression 1: XLSX<br>
Process:</p>

<div class="highlight highlight-sql"><pre><span class="pl-c1">apexir_xlsx_pkg</span>.<span class="pl-c1">download</span>( p_ir_region_id <span class="pl-k">=&gt;</span> :APEXIR_REGION_ID);</pre></div>
</li>
<li><p>Create button on page with interactive report.<br>
Action: Redirect to Page in this Application<br>
Page: The page you are on.<br>
Request: XLSX  </p></li>
</ol>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">APEX IR XLSX Downloader maintained by <a href="https://github.com/commi235">commi235</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
